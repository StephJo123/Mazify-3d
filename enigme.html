<!DOCTYPE html>
<html>

<head>
  <title>Mazify 3D</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="description" content="Mazify 3D" />
  <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Spartan&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="icon" type="image/png" href="assets/images/maze.png" />

  <script>
    var test = true;

    AFRAME.registerComponent('cursor-listener', {
      init: function () {
        this.el.addEventListener('raycaster-intersected', evt => {
          this.raycaster = evt.detail.el;
        });
        this.el.addEventListener('raycaster-intersected-cleared', evt => {
          this.raycaster = null;
        });
      },
      tick: function () {
        if (!this.raycaster) {
          return;
        } // Not intersecting.
        let intersection = this.raycaster.components.raycaster.getIntersection(this.el);
        if (!intersection) {
          return;
        } // Not intersecting
        // intersecting
        if (test) {
          let myEl = document.querySelector('a-gltf-model');
          myEl.setAttribute('scale', '1 1 1');
          // document.getElementById('musique').play();
          setTimeout(function () {
            myEl.setAttribute('scale', '0 0 0');
          }, 2000);
          test = false;
        }
      }
    });
  </script>
</head>

<body>
  <a-scene auto-init-vr inspector-plugin-recast renderer=" colorManagement: true;">

    <!-- Assets -->
    <a-assets>
      <a-asset-item id="room" src="assets/models/room/scene.gltf"></a-asset-item>
      <a-asset-item id="jump" src="assets/models/jumpscare/scene.gltf"></a-asset-item>
    </a-assets>

    <a-sky color="black"></a-sky>
    <a-light type="ambient" color="#fff" intensity="0.8"></a-light>
    <a-plane color="black" rotation="-90 0 0" height="100" width="100"></a-plane>

    <!-- CamÃ©ra rig-->
    <a-entity id="rig" position="-0.2 1 0.014">
      <a-entity id="camera" camera look-controls>
        <a-cursor raycaster="objects: .cursor-listener" visible="true">
          <a-gltf-model position="0 0 1" gltf-model="#jump" id="jump" scale="0 0 0"
            animation-mixer="clip: Black_Ice_Frostbear--Jumpscare">
          </a-gltf-model>
      </a-entity>
    </a-entity>

    <a-entity gltf-model="#room" id="salle" rotation="0 -0.01 0" position="-2.436 3 -2.52">
    </a-entity>

    <a-box id="box3" geometry="width: 0.42; height: 0.3" rotation="40 10 -10" position="-0.70672 2.65016 -2.31071"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box4" geometry="height: 0.31" rotation="40 0 0" position="-0.13 2.71159 -2.49708" height="0.3"
      width="0.45" depth="0.01"></a-box>
    <a-box id="box5" geometry="height: 0.31" position="0.51605 2.77529 -2.27883" rotation="30 -14.999999999999998 0"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box6" geometry="height: 0.28" position="1.15104 2.68509 -2.12674" rotation="29.999999999999996 -35 0"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box10" rotation="35 17 -1" geometry="height: 0.32; width: 0.47" position="-0.7496 2.06036 -2.26586"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box11" rotation="18 0 0" geometry="height: 0.32" position="-0.13 2.02526 -2.42635" height="0.3"
      width="0.45" depth="0.01"></a-box>
    <a-box id="box12" geometry="height: 0.31" rotation="14.999999999999998 -10 0" position="0.51663 2.09937 -2.22542"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box13" geometry="height: 0.31" rotation="25 -29.999999999999996 0" position="1.14554 2.07401 -2.04961"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box16" rotation="12.000000000000002 18 -1" geometry="height: 0.32" position="-0.67633 1.40815 -2.24302"
      height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box17" geometry="height: 0.32" position="-0.114 1.46522 -2.39554" height="0.3" width="0.45" depth="0.01">
    </a-box>
    <a-box id="box18" rotation="0 -10 0" position="0.50046 1.37264 -2.20056" height="0.3" width="0.45" depth="0.01">
    </a-box>
    <a-box id="box19" rotation="10 -25 0" geometry="height: 0.32" position="1.15183 1.4076 -2.02143" height="0.3"
      width="0.45" depth="0.01" class="cursor-listener" cursor-listener></a-box>
    <a-box id="box24" geometry="height: 0.32" rotation="-9.99 10 0" position="-0.74771 0.79264 -2.21767" height="0.3"
      width="0.45" depth="0.01"></a-box>
    <a-box id="box25" rotation="-10.010000000000002 0 0" position="-0.13 0.86 -2.39625" height="0.3" width="0.45"
      depth="0.01"></a-box>
    <a-box id="box26" geometry="height: 0.32" scale="1 1 1" rotation="-29.999999999999996 -10 -2"
      position="0.47168 0.83593 -2.23249" height="0.3" width="0.45" depth="0.01"></a-box>
    <a-box id="box27" geometry="height: 0.33" scale="1 1 1" rotation="-15 -20 -2" position="1.14369 0.77673 -1.977"
      height="0.3" width="0.45" depth="0.01"></a-box>

  </a-scene>

</body>

</html>